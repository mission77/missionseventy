<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="preload" as="image" href="logoz.png">
  <title>Mission Seventy — The Headquarters</title>
  
  <meta property="og:type" content="website">
  <meta property="og:title" id="ogTitle" content="Mission Seventy">
  <meta property="og:description" id="ogDescription" content="The digital headquarters of a builder.">
  <meta property="og:image" id="ogImage" content="https://missionseventy.com/logoz.png">
  <meta property="og:url" id="ogUrl" content="https://missionseventy.com">
  <meta name="twitter:card" content="summary_large_image">

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-D1KZK5NV5L"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-D1KZK5NV5L');
  </script>
  <script defer src="https://cloud.umami.is/script.js" data-website-id="217b616f-3ce0-43cb-bb93-1dc5d77f1d18"></script>
  
  <style>
    /* --- SYSTEM VARIABLES --- */
    :root {
      --sidebar-bg: #050505;
      --sidebar-text: #e0e0e0;
      --canvas-bg: #fcfcf9; /* Warmer, paper-like white */
      --card-bg: #ffffff;
      --text-main: #111111;
      --text-muted: #666666;
      --accent: #FDB515;
      --border: #e5e5e5;
      --line: rgba(0,0,0,0.03);
      
      --font-display: 'Helvetica Neue', Helvetica, Arial, sans-serif;
      --font-body: 'Georgia', serif;
      --font-mono: 'Courier New', Courier, monospace;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body { 
      background: var(--canvas-bg); 
      color: var(--text-main); 
      display: flex; 
      min-height: 100vh;
      font-family: var(--font-display);
    }

    /* Noise Texture for "Masterpiece" Feel */
    body::before {
        content: "";
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.05'/%3E%3C/svg%3E");
        pointer-events: none; z-index: 50;
    }

    /* --- SIDEBAR --- */
    .sidebar {
      width: 300px; height: 100vh; background: var(--sidebar-bg); color: var(--sidebar-text);
      position: sticky; top: 0; display: flex; flex-direction: column; justify-content: space-between;
      padding: 40px 30px; z-index: 100; flex-shrink: 0; border-right: 1px solid #222;
    }

    .brand { display: flex; align-items: center; gap: 15px; margin-bottom: 40px; cursor: pointer; }
    .brand img { width: 48px; height: 48px; border-radius: 50%; border: 2px solid var(--accent); }
    .brand-text h1 { font-size: 14px; font-weight: 800; color: #fff; letter-spacing: 2px; text-transform: uppercase; }
    
    .status-badge { font-family: var(--font-mono); font-size: 10px; color: var(--accent); margin-top: 6px; display: flex; align-items: center; gap: 8px; letter-spacing: 1px; }
    .status-dot { width: 6px; height: 6px; background: var(--accent); border-radius: 50%; box-shadow: 0 0 8px var(--accent); animation: pulse 3s infinite; }
    @keyframes pulse { 0% { opacity: 0.4; } 50% { opacity: 1; } 100% { opacity: 0.4; } }

    .nav-menu { display: flex; flex-direction: column; gap: 0px; }
    .nav-item {
      display: flex; align-items: center; justify-content: space-between;
      padding: 18px 0; color: #666; font-size: 11px; font-weight: 700;
      letter-spacing: 2px; text-transform: uppercase; border-bottom: 1px solid #1a1a1a;
      transition: all 0.3s; cursor: pointer;
    }
    .nav-item:first-child { border-top: 1px solid #1a1a1a; }
    .nav-item:hover { color: #fff; padding-left: 8px; }
    .nav-item.active { color: var(--accent); padding-left: 8px; }
    .nav-num { font-family: var(--font-mono); font-size: 10px; opacity: 0.3; }

    .sidebar-footer { margin-top: auto; }
    .focus-widget { padding: 0; margin-bottom: 30px; }
    .focus-label { font-size: 9px; color: #555; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px; font-weight: 700; }
    .focus-value { font-size: 12px; color: #ccc; line-height: 1.5; font-family: var(--font-mono); border-left: 2px solid var(--accent); padding-left: 12px; }
    
    .socials { display: flex; gap: 15px; margin-top: 20px; }
    .social-icon { color: #444; transition: 0.2s; }
    .social-icon:hover { color: var(--accent); }
    .social-icon svg { width: 18px; height: 18px; fill: currentColor; }

    /* --- WORKSPACE --- */
    .workspace {
      flex: 1; height: 100vh; overflow-y: auto; padding: 50px 70px;
      position: relative; background-image: linear-gradient(var(--line) 1px, transparent 1px), linear-gradient(90deg, var(--line) 1px, transparent 1px);
      background-size: 40px 40px; 
    }

    .top-bar {
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 50px; padding-bottom: 20px; border-bottom: 1px solid #ddd;
    }
    .hijri-display {
      font-family: var(--font-mono); font-size: 12px; color: var(--text-main);
      background: #eee; padding: 6px 12px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px;
    }
    .search-wrap input {
      background: transparent; border: none; border-bottom: 1px solid #ccc;
      padding: 8px 0; font-family: var(--font-mono); font-size: 14px; width: 250px;
      color: var(--text-main); transition: 0.2s;
    }
    .search-wrap input:focus { outline: none; border-bottom: 1px solid var(--text-main); width: 300px; }
    
    /* --- THE DASHBOARD (New "Home" Feel) --- */
    .dashboard-header { margin-bottom: 60px; }
    .dashboard-label { font-family: var(--font-mono); color: var(--accent); font-size: 11px; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 15px; display: block; }
    .dashboard-quote { 
        font-family: var(--font-display); font-size: 36px; font-weight: 800; 
        line-height: 1.1; color: var(--text-main); letter-spacing: -1px; max-width: 800px;
    }
    
    .section-title {
      font-size: 12px; font-weight: 800; margin-bottom: 30px; 
      letter-spacing: 1px; color: var(--text-muted); text-transform: uppercase; border-bottom: 2px solid var(--accent); display: inline-block; padding-bottom: 5px;
    }

    /* --- FEED STYLE --- */
    .log-entry {
      background: var(--card-bg); border: 1px solid var(--text-main); padding: 35px;
      margin-bottom: 30px; transition: transform 0.2s; cursor: pointer;
      box-shadow: 8px 8px 0 rgba(0,0,0,0.03); display: flex; flex-direction: column;
    }
    .log-entry:hover { transform: translate(-2px, -2px); box-shadow: 8px 8px 0 var(--accent); }

    .entry-title { font-size: 26px; font-weight: 700; margin-bottom: 12px; line-height: 1.3; letter-spacing: -0.5px; }
    .entry-excerpt { font-family: var(--font-body); font-size: 18px; color: #444; line-height: 1.6; margin-bottom: 25px; flex-grow: 1; }
    .entry-footer {
      border-top: 1px solid #eee; padding-top: 15px; margin-top: 10px;
      font-family: var(--font-mono); font-size: 11px; color: #999; text-transform: uppercase; letter-spacing: 1px;
      display: flex; justify-content: space-between;
    }

    /* --- PRODUCT CARD --- */
    .system-card {
      background: #111; color: #fff; padding: 40px; margin-bottom: 60px;
      display: grid; grid-template-columns: 1fr auto; gap: 40px; align-items: center;
      position: relative; overflow: hidden; border-radius: 2px;
    }
    .system-card::before { content: ""; position: absolute; top: 0; left: 0; width: 6px; height: 100%; background: var(--accent); }
    .system-info h3 { font-size: 24px; margin-bottom: 10px; color: #fff; letter-spacing: -0.5px; }
    .system-info p { color: #888; font-family: var(--font-body); font-size: 16px; line-height: 1.5; max-width: 500px; }
    .system-action a {
      background: var(--accent); color: #000; text-decoration: none; padding: 14px 28px;
      font-weight: 800; font-size: 11px; display: inline-block; text-transform: uppercase;
      letter-spacing: 1px; transition: transform 0.2s;
    }
    .system-action a:hover { transform: translateY(-2px); background: #fff; }

    /* --- SINGLE POST --- */
    .single-view { display: none; background: #fff; padding: 70px; border: 1px solid #ddd; max-width: 800px; margin: 0 auto; box-shadow: 20px 20px 0 rgba(0,0,0,0.02); }
    .single-view.active { display: block; animation: fadeIn 0.4s ease; }
    
    .back-link { 
      display: inline-flex; align-items: center; gap: 8px;
      font-family: var(--font-mono); font-size: 11px; font-weight: 700; 
      color: #999; cursor: pointer; margin-bottom: 50px; 
      text-transform: uppercase; letter-spacing: 1px;
    }
    .back-link:hover { color: var(--text-main); }
    
    .article-header { margin-bottom: 30px; }
    .article-date-footer { 
      font-family: var(--font-mono); color: var(--text-muted); font-weight: 700; font-size: 11px; 
      margin-top: 50px; padding-top: 30px; border-top: 1px solid #eee; 
      display: block; text-align: center; text-transform: uppercase; letter-spacing: 2px;
    }
    
    .article-body { font-family: var(--font-body); font-size: 21px; line-height: 1.7; color: #222; }
    .article-body p { margin-bottom: 30px; } 
    .article-body h2 { font-size: 28px; margin-top: 50px; margin-bottom: 20px; letter-spacing: -0.5px; }

    /* Post Navigation */
    .post-nav { margin-top: 40px; display: flex; justify-content: space-between; gap: 20px; }
    .nav-btn { flex: 1; padding: 25px; border: 1px solid #eee; cursor: pointer; transition: 0.2s; text-align: left; }
    .nav-btn:hover { border-color: var(--accent); background: #fff; }
    .nav-btn.disabled { opacity: 0.3; pointer-events: none; }
    .nav-label { font-family: var(--font-mono); font-size: 10px; color: #999; text-transform: uppercase; display: block; margin-bottom: 8px; letter-spacing: 1px; }
    .nav-title { font-size: 14px; font-weight: 700; color: #000; }
    .nav-btn.next { text-align: right; }

    /* Share Section */
    .share-section { margin-top: 40px; padding: 20px; background: #f9f9f9; display: flex; align-items: center; justify-content: space-between; border: 1px solid #eee; }
    .share-label { font-family: var(--font-mono); font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; }
    .copy-btn { background: #fff; border: 1px solid #ccc; padding: 8px 20px; font-size: 11px; font-weight: 700; cursor: pointer; transition: 0.2s; text-transform: uppercase; letter-spacing: 1px; }
    .copy-btn:hover { border-color: #000; color: #000; }

    /* --- ABOUT & PROJECTS --- */
    .mission-text p { font-size: 22px; line-height: 1.6; margin-bottom: 30px; font-family: var(--font-body); color: #222; }
    .mission-list { list-style: none; margin: 40px 0; border-left: 4px solid var(--accent); padding-left: 30px; }
    .mission-list li { font-family: var(--font-display); font-size: 20px; font-weight: 700; margin-bottom: 15px; color: #111; letter-spacing: -0.5px; }

    .project-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 30px; }
    .project-card { background: #fff; border: 1px solid var(--border); padding: 40px; display: flex; flex-direction: column; justify-content: space-between; height: 100%; transition: 0.2s; }
    .project-card:hover { border-color: var(--accent); transform: translateY(-3px); }
    .project-card h3 { font-size: 24px; margin-bottom: 8px; font-weight: 800; letter-spacing: -0.5px; }
    .project-tag { font-family: var(--font-mono); font-size: 10px; color: #fff; background: #000; padding: 4px 8px; display: inline-block; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 1px; }
    .project-desc { font-family: var(--font-body); font-size: 16px; color: #666; margin-bottom: 30px; line-height: 1.6; }
    .project-link { font-size: 11px; font-weight: 800; color: var(--text-main); text-decoration: none; border-bottom: 2px solid var(--accent); padding-bottom: 4px; align-self: flex-start; text-transform: uppercase; letter-spacing: 1px; }

    /* Sections Visibility */
    #postsSection, #aboutSection, #projectsSection, #searchResultsPage { display: none; }
    #postsSection.active, #aboutSection.active, #projectsSection.active, #searchResultsPage.active { display: block; animation: fadeIn 0.5s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    /* --- RESPONSIVE MOBILE --- */
    @media (max-width: 900px) {
      body { flex-direction: column; }
      .sidebar { width: 100%; height: auto; position: relative; padding: 25px 20px; border-right: none; border-bottom: 1px solid #333; }
      .workspace { padding: 30px 20px; height: auto; background-image: none; }
      
      .dashboard-quote { font-size: 26px; margin-bottom: 30px; }
      .entry-title { font-size: 22px; }
      .article-body { font-size: 18px; line-height: 1.6; }
      
      .system-card { grid-template-columns: 1fr; text-align: center; padding: 30px 20px; gap: 20px; }
      .system-card::before { width: 100%; height: 4px; top: 0; left: 0; }
      
      .top-bar { margin-bottom: 20px; gap: 10px; flex-direction: column-reverse; align-items: flex-start; }
      .search-wrap input { width: 100%; }
      .single-view { padding: 0; box-shadow: none; border: none; background: transparent; }
      .post-nav { flex-direction: column; margin-top: 20px; }
      .nav-btn.next { text-align: left; }
    }
  </style>
</head>
<body>

  <aside class="sidebar">
    <div>
      <div class="brand" id="logoClick">
        <img src="logoz.png" alt="M70">
        <div class="brand-text">
          <h1>Mission Seventy</h1>
          <div class="status-badge">
            <div class="status-dot"></div>
            <span>STATUS: ACTIVE</span>
          </div>
        </div>
      </div>

      <nav class="nav-menu">
        <div class="nav-item active" data-tab="blog">
          <span>Headquarters</span>
          <span class="nav-num">01</span>
        </div>
        <div class="nav-item" data-tab="project">
          <span>Shipments</span>
          <span class="nav-num">02</span>
        </div>
        <div class="nav-item" data-tab="about">
          <span>The Mission</span>
          <span class="nav-num">03</span>
        </div>
      </nav>
    </div>

    <div class="sidebar-footer">
      <div class="focus-widget">
        <div class="focus-label">Current Objective</div>
        <div class="focus-value">Building Nurayni platform.</div>
      </div>

      <div class="socials">
        <a href="https://www.instagram.com/missionseventy" target="_blank" class="social-icon" title="Instagram">
          <svg viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg>
        </a>
        <a href="YOUR_TIKTOK_LINK_HERE" target="_blank" class="social-icon" title="TikTok">
          <svg viewBox="0 0 24 24"><path d="M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z"/></svg>
        </a>
      </div>
    </div>
  </aside>

  <main class="workspace">
    
    <div class="top-bar">
      <div class="search-wrap">
        <input type="text" id="searchInput" placeholder="Search logs...">
      </div>
      <div class="hijri-display" id="dateDisplay"></div>
    </div>

    <div id="postsSection" class="active">
      <div class="dashboard-header">
        <span class="dashboard-label">Daily Briefing</span>
        <div class="dashboard-quote" id="quoteDisplay">Loading inspiration...</div>
      </div>

      <h2 class="section-title">System Status</h2>
      
      <div class="system-card">
        <div class="system-info">
          <h3>The Seventy System</h3>
          <p>A 7x11 content framework designed for consistent output without burnout. Used by builders, writers, and thinkers.</p>
        </div>
        <div class="system-action">
          <a href="https://missionseventy.gumroad.com/l/cpseyb" target="_blank">Access System ($21)</a>
        </div>
      </div>

      <h2 class="section-title">Recent Logs</h2>
      <div id="postsFeed"></div>
    </div>

    <div id="projectsSection">
      <h2 class="section-title">Shipments.</h2>
      <div class="project-grid">
        <div class="project-card">
          <div>
            <span class="project-tag">LIVE</span>
            <h3>Qiblatak</h3>
            <p class="project-desc">A minimal, privacy-focused Qibla finder and prayer time utility. Built for focus, accurate from any location.</p>
          </div>
          <a href="https://qiblatak.com" target="_blank" class="project-link">Launch App -></a>
        </div>
        <div class="project-card">
          <div>
            <span class="project-tag">BUILDING</span>
            <h3>Nurayni</h3>
            <p class="project-desc">Authentic Islamic wisdom and reflection. A platform dedicated to nurturing Iman through the two lights.</p>
          </div>
          <span class="project-link" style="color:#aaa; border-color:#aaa; cursor:default">In Progress</span>
        </div>
      </div>
    </div>

    <div id="aboutSection">
      <h2 class="section-title">The Mission.</h2>
      
      <div class="single-view active" style="margin:0; width:100%; max-width:100%; padding:0; box-shadow:none; border:none; animation:none; background:transparent;">
        <div class="mission-text">
          <p><strong>BISMILLAH.</strong></p>
          <p>Mission Seventy is my laboratory for making what matters work. This blog is where I share observations on faith, building, and finding solutions.</p>
          
          <ul class="mission-list">
             <li>As a builder, I write to think clearly.</li>
             <li>To see ideas in the open.</li>
             <li>To refine them.</li>
           </ul>

          <p>This is my main platform beyond social media. Here you'll find finished projects, upcoming work, and resources; some free, some paid.</p>
          
          <p>I build in public to refine my understanding. Corrections and discourse are always welcome.</p>
          
          <p style="margin-top: 40px; font-style: italic; color: #666;">Ahlan wa sahlan, Ha dhawaaw/Soo dhawoow, Karibu, welcome.</p>
        </div>
      </div>
    </div>

    <div class="single-view" id="singlePostView">
      <div class="back-link" id="backBtn"><span>← Return to Log</span></div>
      
      <h1 style="font-size: 38px; font-weight: 700; line-height: 1.2;" id="singlePostTitle"></h1>
      
      <div class="article-body" id="singlePostBody" style="margin-top: 30px;"></div>

      <div class="article-date-footer" id="singlePostDate"></div>
      
      <div class="share-section">
        <span class="share-label">Share this log</span>
        <button class="copy-btn" id="shareCopyBtn">COPY LINK</button>
      </div>

      <div class="post-nav">
        <div class="nav-btn prev" id="prevPostBtn">
          <span class="nav-label">Previous Log</span>
          <div class="nav-title" id="prevPostTitle">Title</div>
        </div>
        <div class="nav-btn next" id="nextPostBtn">
          <span class="nav-label">Next Log</span>
          <div class="nav-title" id="nextPostTitle">Title</div>
        </div>
      </div>
    </div>

    <div id="searchResultsPage">
      <h2 class="section-title">Query Results.</h2>
      <div id="searchResultsList"></div>
      <div class="back-link" id="clearSearchBtn" style="margin-top: 20px;">CLEAR SEARCH</div>
    </div>

  </main>

  <script src="posts.js"></script>
  <script>
    // --- QUOTE ENGINE (The "Energy") ---
    const builderQuotes = [
        "Indeed, Allah loves that when one of you does a deed, he does it with excellence (Ihsan).",
        "Build in public. Think in public. Grow in public.",
        "The standard you walk past is the standard you accept.",
        "Sincerity (Ikhlas) is the foundation of every structure.",
        "Write to understand. Build to solve.",
        "Small consistent actions > Grand intentions.",
        "Your output depends on the quality of your input.",
        "Seek knowledge from the cradle to the grave."
    ];

    // --- APP CONTROLLER ---
    const app = {
      views: {
        blog: document.getElementById('postsSection'),
        project: document.getElementById('projectsSection'),
        about: document.getElementById('aboutSection'),
        single: document.getElementById('singlePostView'),
        search: document.getElementById('searchResultsPage')
      },
      nav: document.querySelectorAll('.nav-item'),
      feed: document.getElementById('postsFeed'),
      dateEl: document.getElementById('dateDisplay'),
      quoteEl: document.getElementById('quoteDisplay'),
      currentPostIndex: -1
    };

    function init() {
      renderHijriDate();
      renderQuote();
      renderFeed();
      setupListeners();
      checkUrlParams();
    }

    function renderHijriDate() {
        try {
            const now = new Date();
            const options = { day: 'numeric', month: 'long', year: 'numeric', calendar: 'islamic-civil' };
            const formatter = new Intl.DateTimeFormat('en-US-u-ca-islamic-civil', options);
            const parts = formatter.formatToParts(now);
            const day = parts.find(p => p.type === 'day').value;
            const month = parts.find(p => p.type === 'month').value;
            const year = parts.find(p => p.type === 'year').value;
            app.dateEl.textContent = `${month.toUpperCase()} ${day}, ${year} AH`;
        } catch (e) {
            app.dateEl.textContent = new Date().toLocaleDateString();
        }
    }

    function renderQuote() {
        const randomQuote = builderQuotes[Math.floor(Math.random() * builderQuotes.length)];
        app.quoteEl.textContent = randomQuote;
    }

    function renderFeed() {
      if (typeof posts === 'undefined' || posts.length === 0) {
        app.feed.innerHTML = '<div class="log-entry" style="padding: 20px; border: 1px solid #ccc; font-family:var(--font-mono); color: var(--text-muted); text-align:center;">NO LOGS FOUND. PUBLISH YOUR FIRST POST.</div>';
        return;
      }

      app.feed.innerHTML = '';
      const sortedPosts = [...posts].sort((a, b) => b.id - a.id);

      sortedPosts.forEach(post => {
        const el = document.createElement('div');
        el.className = 'log-entry';
        el.innerHTML = `
          <h3 class="entry-title">${post.title}</h3>
          <div class="entry-excerpt">${post.excerpt}</div>
          <div class="entry-footer">
             <div>LOG #${post.id}</div>
             <div>${post.date}</div>
          </div>
        `;
        el.onclick = () => openPost(post);
        app.feed.appendChild(el);
      });
    }

    function updateMetaTags(post) {
      const postUrl = window.location.origin + window.location.pathname + '?post=' + post.id;
      document.title = `${post.title} — Mission Seventy`;
      document.querySelector('#ogTitle').setAttribute('content', post.title);
      document.querySelector('#ogDescription').setAttribute('content', post.excerpt);
      document.querySelector('#ogUrl').setAttribute('content', postUrl);
    }

    function openPost(post) {
      Object.values(app.views).forEach(el => el.classList.remove('active'));
      app.views.single.classList.add('active');
      
      document.getElementById('singlePostTitle').textContent = post.title;
      document.getElementById('singlePostDate').textContent = post.date;
      document.getElementById('singlePostBody').innerHTML = post.body;
      
      window.history.pushState({postId: post.id}, post.title, `?post=${post.id}`);
      updateMetaTags(post);
      window.scrollTo(0,0);

      const index = posts.findIndex(p => p.id === post.id);
      app.currentPostIndex = index;
      updatePostNavigation(index);
    }

    function updatePostNavigation(currentIndex) {
      const prevBtn = document.getElementById('prevPostBtn');
      const nextBtn = document.getElementById('nextPostBtn');
      
      if (currentIndex > 0) {
        const newer = posts[currentIndex - 1];
        prevBtn.classList.remove('disabled');
        document.getElementById('prevPostTitle').textContent = newer.title;
        prevBtn.onclick = () => openPost(newer);
      } else {
        prevBtn.classList.add('disabled');
        document.getElementById('prevPostTitle').textContent = "None";
      }

      if (currentIndex < posts.length - 1) {
        const older = posts[currentIndex + 1];
        nextBtn.classList.remove('disabled');
        document.getElementById('nextPostTitle').textContent = older.title;
        nextBtn.onclick = () => openPost(older);
      } else {
        nextBtn.classList.add('disabled');
        document.getElementById('nextPostTitle').textContent = "None";
      }
    }

    function closePost() {
      switchTab('blog');
      document.title = 'Mission Seventy — The Headquarters';
      history.pushState(null, null, window.location.pathname); 
    }

    function switchTab(tabName) {
      app.nav.forEach(el => el.classList.toggle('active', el.dataset.tab === tabName));
      Object.values(app.views).forEach(el => el.classList.remove('active'));
      if(app.views[tabName]) app.views[tabName].classList.add('active');
      window.scrollTo(0,0);
    }

    function setupListeners() {
      app.nav.forEach(btn => btn.addEventListener('click', (e) => switchTab(btn.dataset.tab)));
      document.getElementById('logoClick').addEventListener('click', () => switchTab('blog'));
      document.getElementById('backBtn').addEventListener('click', closePost);
      document.getElementById('clearSearchBtn').addEventListener('click', () => switchTab('blog'));
      
      const searchInput = document.getElementById('searchInput');
      searchInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') runSearch(searchInput.value.toLowerCase()); });

      document.getElementById('shareCopyBtn').addEventListener('click', () => {
        const url = window.location.href;
        navigator.clipboard.writeText(url).then(() => {
          const btn = document.getElementById('shareCopyBtn');
          const originalText = btn.textContent;
          btn.textContent = "COPIED!";
          setTimeout(() => btn.textContent = originalText, 2000);
        });
      });
    }

    function checkUrlParams() {
      const urlParams = new URLSearchParams(window.location.search);
      const postId = urlParams.get('post');
      if (postId && typeof posts !== 'undefined') {
        const post = posts.find(p => p.id == postId);
        if (post) openPost(post);
      } else {
          switchTab('blog');
      }
    }

    init();
  </script>
</body>
</html>

