<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="preload" as="image" href="logoz.png">
  <title>Mission Seventy — The Laboratory</title>
  
  <meta property="og:type" content="website">
  <meta property="og:title" content="Mission Seventy">
  <meta property="og:description" content="Systems, Faith, and Software. The workshop of a builder.">
  <meta property="og:image" content="https://missionseventy.com/logoz.png">
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-D1KZK5NV5L"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-D1KZK5NV5L');
  </script>
  <script defer src="https://cloud.umami.is/script.js" data-website-id="217b616f-3ce0-43cb-bb93-1dc5d77f1d18"></script>
  
  <style>
    /* --- SYSTEM VARIABLES --- */
    :root {
      --sidebar-bg: #0a0a0a;
      --sidebar-text: #e0e0e0;
      --canvas-bg: #fdfdfc;
      --card-bg: #ffffff;
      --text-main: #111111;
      --text-muted: #666666;
      --accent: #FDB515;
      --border: #e5e5e5;
      --line: rgba(0,0,0,0.04);
      
      --font-display: 'Helvetica Neue', Helvetica, Arial, sans-serif;
      --font-body: 'Georgia', serif;
      --font-mono: 'Courier New', Courier, monospace;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body { 
      background: var(--canvas-bg); 
      color: var(--text-main); 
      display: flex; 
      min-height: 100vh;
      font-family: var(--font-display);
    }

    /* --- SIDEBAR --- */
    .sidebar {
      width: 300px;
      background: var(--sidebar-bg);
      color: var(--sidebar-text);
      height: 100vh;
      position: sticky;
      top: 0;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding: 40px 30px;
      z-index: 100;
      flex-shrink: 0;
    }

    .brand { display: flex; align-items: center; gap: 15px; margin-bottom: 50px; cursor: pointer; }
    .brand img { width: 48px; height: 48px; border-radius: 50%; border: 2px solid var(--accent); }
    .brand-text h1 { font-size: 15px; font-weight: 700; color: #fff; letter-spacing: 1px; text-transform: uppercase; }
    
    .status-badge {
      font-family: var(--font-mono); font-size: 10px; color: var(--accent); margin-top: 5px;
      display: flex; align-items: center; gap: 6px;
    }
    .status-dot {
      width: 6px; height: 6px; background: var(--accent); border-radius: 50%;
      box-shadow: 0 0 5px var(--accent); animation: pulse 2s infinite;
    }
    @keyframes pulse { 0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; } }

    .nav-menu { display: flex; flex-direction: column; gap: 2px; }
    .nav-item {
      display: flex; align-items: center; justify-content: space-between;
      padding: 16px 0; color: #777; text-decoration: none; font-size: 12px;
      font-weight: 700; letter-spacing: 1.5px; text-transform: uppercase;
      border-bottom: 1px solid #222; transition: all 0.2s; cursor: pointer;
    }
    .nav-item:hover { color: #fff; padding-left: 5px; }
    .nav-item.active { color: var(--accent); border-bottom: 1px solid var(--accent); padding-left: 5px; }
    .nav-num { font-family: var(--font-mono); font-size: 10px; opacity: 0.4; }

    .sidebar-footer { margin-top: auto; }
    .focus-widget {
      background: #151515; padding: 20px; border-radius: 4px; margin-bottom: 25px;
      border-left: 2px solid var(--accent);
    }
    .focus-label { font-size: 9px; color: #888; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px; font-weight: 700; }
    .focus-value { font-size: 13px; color: #fff; line-height: 1.5; font-family: var(--font-body); font-style: italic; }
    
    .socials { display: flex; gap: 15px; margin-top: 20px; }
    .social-icon { color: #555; transition: 0.2s; }
    .social-icon:hover { color: var(--accent); }
    .social-icon svg { width: 18px; height: 18px; fill: currentColor; }

    /* --- WORKSPACE --- */
    .workspace {
      flex: 1; height: 100vh; overflow-y: auto; padding: 60px 80px; position: relative;
      background-image: linear-gradient(var(--line) 1px, transparent 1px), linear-gradient(90deg, var(--line) 1px, transparent 1px);
      background-size: 40px 40px; 
    }

    .top-bar {
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 70px; padding-bottom: 20px; border-bottom: 2px solid var(--text-main);
    }
    .hijri-display {
      font-family: var(--font-mono); font-size: 13px; color: var(--text-main);
      background: var(--accent); padding: 6px 12px; font-weight: 700; text-transform: uppercase;
    }
    .search-wrap input {
      background: transparent; border: none; border-bottom: 1px solid #ccc;
      padding: 8px 0; font-family: var(--font-mono); font-size: 14px; width: 250px;
      color: var(--text-main); transition: 0.2s;
    }
    .search-wrap input:focus { outline: none; border-bottom: 1px solid var(--text-main); width: 300px; }
    
    .section-title {
      font-size: 56px; font-weight: 800; line-height: 1; margin-bottom: 50px;
      letter-spacing: -1.5px; color: var(--text-main);
    }

    /* --- FEED STYLE --- */
    .log-entry {
      background: var(--card-bg); border: 1px solid var(--text-main); padding: 35px;
      margin-bottom: 30px; transition: transform 0.2s; cursor: pointer;
      box-shadow: 4px 4px 0 rgba(0,0,0,0.05); display: flex; flex-direction: column;
    }
    .log-entry:hover { transform: translate(-2px, -2px); box-shadow: 6px 6px 0 var(--accent); }

    .entry-title { font-size: 28px; font-weight: 700; margin-bottom: 12px; line-height: 1.3; }
    .entry-excerpt { font-family: var(--font-body); font-size: 17px; color: var(--text-muted); line-height: 1.6; margin-bottom: 20px; flex-grow: 1; }
    .entry-footer {
      border-top: 1px solid #eee; padding-top: 15px; margin-top: auto;
      font-family: var(--font-mono); font-size: 11px; color: #888; text-transform: uppercase;
      display: flex; justify-content: space-between;
    }

    /* --- PRODUCT CARD --- */
    .system-card {
      background: #1a1a1a; color: #fff; padding: 45px; margin-bottom: 60px;
      display: grid; grid-template-columns: 1fr auto; gap: 40px; align-items: center;
      position: relative; overflow: hidden;
    }
    .system-card::before { content: ""; position: absolute; top: 0; left: 0; width: 4px; height: 100%; background: var(--accent); }
    .system-info h3 { font-size: 28px; margin-bottom: 12px; color: #fff; letter-spacing: -0.5px; }
    .system-info p { color: #aaa; font-family: var(--font-body); font-size: 16px; line-height: 1.6; max-width: 550px; }
    .system-action a {
      background: var(--accent); color: #000; text-decoration: none; padding: 16px 32px;
      font-weight: 800; font-size: 13px; display: inline-block; text-transform: uppercase;
      letter-spacing: 1px; transition: transform 0.2s;
    }
    .system-action a:hover { transform: scale(1.05); background: #fff; }

    /* --- SINGLE POST --- */
    .single-view { display: none; background: #fff; padding: 60px; border: 1px solid var(--border); max-width: 850px; margin: 0 auto; }
    .single-view.active { display: block; animation: fadeIn 0.4s ease; }
    
    .back-link { 
      display: inline-flex; align-items: center; gap: 8px;
      font-family: var(--font-mono); font-size: 11px; font-weight: 700; 
      color: var(--text-muted); cursor: pointer; margin-bottom: 40px; 
      text-transform: uppercase; letter-spacing: 1px;
    }
    .back-link:hover { color: var(--accent); }
    
    .article-header { margin-bottom: 40px; border-bottom: 1px solid #eee; padding-bottom: 30px; }
    .article-date { font-family: var(--font-mono); color: var(--accent); font-weight: 700; font-size: 12px; margin-top: 15px; display: block; }
    .article-body { font-family: var(--font-body); font-size: 20px; line-height: 1.8; color: #222; }
    .article-body p { margin-bottom: 28px; max-width: 700px; } 
    .article-body h2 { font-size: 28px; margin-top: 40px; margin-bottom: 20px; font-family: var(--font-display); }

    /* Post Navigation (Next/Prev) */
    .post-nav { 
      margin-top: 60px; border-top: 1px solid #eee; padding-top: 30px; 
      display: flex; justify-content: space-between; gap: 20px;
    }
    .nav-btn {
      flex: 1; padding: 20px; border: 1px solid #eee; cursor: pointer; transition: 0.2s;
      text-align: left;
    }
    .nav-btn:hover { border-color: var(--accent); background: #fafafa; }
    .nav-btn.disabled { opacity: 0.3; pointer-events: none; border-color: #eee; }
    .nav-label { font-family: var(--font-mono); font-size: 10px; color: #888; text-transform: uppercase; display: block; margin-bottom: 5px; }
    .nav-title { font-size: 14px; font-weight: 700; color: #000; }
    .nav-btn.next { text-align: right; }

    /* Share Section */
    .share-section { margin-top: 40px; padding: 20px; background: #fafafa; border-radius: 4px; display: flex; align-items: center; justify-content: space-between; }
    .share-label { font-family: var(--font-mono); font-size: 11px; font-weight: 700; text-transform: uppercase; }
    .copy-btn { background: #fff; border: 1px solid #ddd; padding: 8px 16px; font-size: 12px; font-weight: 700; cursor: pointer; transition: 0.2s; }
    .copy-btn:hover { border-color: var(--accent); color: var(--accent); }

    /* --- ABOUT & PROJECTS --- */
    .mission-text p { font-size: 20px; line-height: 1.7; margin-bottom: 25px; font-family: var(--font-body); color: #222; }
    .mission-list { list-style: none; margin: 30px 0; border-left: 3px solid var(--accent); padding-left: 20px; }
    .mission-list li { font-family: var(--font-display); font-size: 18px; font-weight: 700; margin-bottom: 12px; color: #111; }

    .project-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 30px; }
    .project-card { background: #fff; border: 1px solid var(--border); padding: 35px; display: flex; flex-direction: column; justify-content: space-between; height: 100%; transition: 0.2s; }
    .project-card:hover { border-color: var(--accent); transform: translateY(-3px); }
    .project-card h3 { font-size: 24px; margin-bottom: 8px; }
    .project-tag { font-family: var(--font-mono); font-size: 10px; color: #fff; background: #000; padding: 4px 8px; display: inline-block; margin-bottom: 15px; text-transform: uppercase; }
    .project-desc { font-family: var(--font-body); font-size: 16px; color: var(--text-muted); margin-bottom: 25px; line-height: 1.5; }
    .project-link { font-size: 12px; font-weight: 800; color: var(--text-main); text-decoration: none; border-bottom: 3px solid var(--accent); padding-bottom: 2px; align-self: flex-start; text-transform: uppercase; letter-spacing: 1px; }

    /* Sections Visibility */
    #postsSection, #aboutSection, #projectsSection, #searchResultsPage { display: none; }
    #postsSection.active, #aboutSection.active, #projectsSection.active, #searchResultsPage.active { display: block; animation: fadeIn 0.4s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    /* --- RESPONSIVE MOBILE --- */
    @media (max-width: 900px) {
      body { flex-direction: column; }
      .sidebar { width: 100%; height: auto; position: relative; padding: 25px 20px; border-right: none; border-bottom: 1px solid #333; }
      .workspace { padding: 40px 20px; height: auto; background-image: none; }
      
      .section-title { font-size: 32px; margin-bottom: 30px; letter-spacing: -1px; }
      .entry-title { font-size: 22px; }
      .article-body { font-size: 17px; line-height: 1.6; }
      .article-body p { max-width: 100%; }

      .brand { margin-bottom: 25px; justify-content: center; }
      .nav-menu { flex-direction: row; justify-content: space-around; border-top: 1px solid #222; padding-top: 10px; }
      .nav-item { border: none; padding: 10px 5px; font-size: 11px; letter-spacing: 0.5px; }
      .nav-item.active { border: none; color: var(--accent); padding-left: 5px; }
      .nav-num, .focus-widget, .socials { display: none; }
      
      .top-bar { margin-bottom: 40px; gap: 15px; flex-direction: column-reverse; align-items: flex-start; }
      .search-wrap input { width: 100%; }
      .system-card { grid-template-columns: 1fr; text-align: center; padding: 30px 20px; gap: 20px; }
      .system-card::before { width: 100%; height: 4px; top: 0; left: 0; }
      .single-view { padding: 0; box-shadow: none; border: none; }
      .post-nav { flex-direction: column; }
      .nav-btn.next { text-align: left; }
    }
  </style>
</head>
<body>

  <aside class="sidebar">
    <div>
      <div class="brand" id="logoClick">
        <img src="logoz.png" alt="M70">
        <div class="brand-text">
          <h1>Mission Seventy</h1>
          <div class="status-badge">
            <div class="status-dot"></div>
            <span>STATUS: ACTIVE</span>
          </div>
        </div>
      </div>

      <nav class="nav-menu">
        <div class="nav-item active" data-tab="blog">
          <span>Logbook</span>
          <span class="nav-num">01</span>
        </div>
        <div class="nav-item" data-tab="project">
          <span>Shipments</span>
          <span class="nav-num">02</span>
        </div>
        <div class="nav-item" data-tab="about">
          <span>The Mission</span>
          <span class="nav-num">03</span>
        </div>
      </nav>
    </div>

    <div class="sidebar-footer">
      <div class="focus-widget">
        <div class="focus-label">Current Objective</div>
        <div class="focus-value">Building Nurayni platform.</div>
      </div>

      <div class="socials">
        <a href="https://www.instagram.com/missionseventy" target="_blank" class="social-icon" title="Instagram">
          <svg viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg>
        </a>
        
        <a href="YOUR_TIKTOK_LINK_HERE" target="_blank" class="social-icon" title="TikTok">
          <svg viewBox="0 0 24 24">
            <path d="M12.3 2.025c.3.176.4.385.4.594v1.272c.002.392-.047.887-.27 1.354-.223.467-.61.905-1.16 1.314v8.527c-.002.508-.415.92-.924.918-.508 0-.92-.412-.918-.92V6.632c-.553-.41-1.026-.848-1.25-1.314-.223-.467-.272-.962-.27-1.354V2.62c0-.21.1-.418.4-.594 2.822-1.645 5.86-2.025 8.4-2.025zm-2.003 14.88c-.002.508-.415.92-.924.918-.508 0-.92-.412-.918-.92v-7.23c-1.43.08-2.61.474-3.66 1.183-1.05.708-1.92 1.69-2.71 2.923v1.364c.002.508-.415.92-.924.918-.508 0-.92-.412-.918-.92v-1.365c.89-1.36 1.94-2.43 3.16-3.216 1.22-.785 2.65-1.18 4.29-1.18 1.63 0 3.06.395 4.29 1.18 1.22.785 2.27 1.856 3.16 3.216v7.23c-.002.508-.415.92-.924.918-.508 0-.92-.412-.918-.92v-8.527c-1.57-.49-3.22-.74-4.84-.74-1.62 0-3.27.25-4.84.74z"/>
          </svg>
        </a>
      </div>
    </div>
  </aside>

  <main class="workspace">
    
    <div class="top-bar">
      <div class="search-wrap">
        <input type="text" id="searchInput" placeholder="Search logs...">
      </div>
      <div class="hijri-display" id="dateDisplay"></div>
    </div>

    <div id="postsSection" class="active">
      <h2 class="section-title">The Laboratory.</h2>
      
      <div class="system-card">
        <div class="system-info">
          <h3>The Seventy System</h3>
          <p>Never wonder what to post again. A 7x11 content framework designed for consistent output without burnout. Used by builders, writers, and thinkers.</p>
        </div>
        <div class="system-action">
          <a href="https://missionseventy.gumroad.com/l/cpseyb" target="_blank">Access System ($21)</a>
        </div>
      </div>

      <div id="postsFeed"></div>
    </div>

    <div id="projectsSection">
      <h2 class="section-title">Shipments.</h2>
      <div class="project-grid">
        <div class="project-card">
          <div>
            <span class="project-tag">LIVE</span>
            <h3>Qiblatak</h3>
            <p class="project-desc">A minimal, privacy-focused Qibla finder and prayer time utility. Built for focus, accurate from any location.</p>
          </div>
          <a href="https://qiblatak.com" target="_blank" class="project-link">Launch App -></a>
        </div>
        <div class="project-card">
          <div>
            <span class="project-tag">BUILDING</span>
            <h3>Nurayni</h3>
            <p class="project-desc">Authentic Islamic wisdom and reflection. A platform dedicated to nurturing Iman through the two lights.</p>
          </div>
          <span class="project-link" style="color:#aaa; border-color:#aaa; cursor:default">In Progress</span>
        </div>
      </div>
    </div>

    <div id="aboutSection">
      <h2 class="section-title">The Mission.</h2>
      
      <div class="single-view active" style="margin:0; width:100%; max-width:100%; padding:0; box-shadow:none; border:none; animation:none;">
        <div class="mission-text">
          <p><strong>BISMILLAH.</strong></p>
          <p>Mission Seventy is my laboratory for making what matters work. This blog is where I share observations on faith, building, and finding solutions.</p>
          
          <ul class="mission-list">
             <li>As a builder, I write to think clearly.</li>
             <li>To see ideas in the open.</li>
             <li>To refine them.</li>
           </ul>

          <p>This is my main platform beyond social media. Here you'll find finished projects, upcoming work, and resources; some free, some paid.</p>
          
          <p>I build in public to refine my understanding. Corrections and discourse are always welcome.</p>
          
          <p style="margin-top: 40px; font-style: italic; color: #666;">Ahlan wa sahlan, Ha dhawaaw/Soo dhawoow, Karibu, welcome.</p>
        </div>
      </div>
    </div>

    <div class="single-view" id="singlePostView">
      <div class="back-link" id="backBtn"><span>← Return to Log</span></div>
      
      <h1 style="font-size: 38px; font-weight: 700; line-height: 1.2;" id="singlePostTitle"></h1>
      <span class="article-date" id="singlePostDate"></span>
      
      <div class="article-body" id="singlePostBody" style="margin-top: 30px;"></div>
      
      <div class="share-section">
        <span class="share-label">Share this log</span>
        <button class="copy-btn" id="shareCopyBtn">COPY LINK</button>
      </div>

      <div class="post-nav">
        <div class="nav-btn prev" id="prevPostBtn">
          <span class="nav-label">Previous Log</span>
          <div class="nav-title" id="prevPostTitle">Title</div>
        </div>
        <div class="nav-btn next" id="nextPostBtn">
          <span class="nav-label">Next Log</span>
          <div class="nav-title" id="nextPostTitle">Title</div>
        </div>
      </div>
    </div>

    <div id="searchResultsPage">
      <h2 class="section-title">Query Results.</h2>
      <div id="searchResultsList"></div>
      <div class="back-link" id="clearSearchBtn" style="margin-top: 20px;">CLEAR SEARCH</div>
    </div>

  </main>

  <script src="posts.js"></script>
  <script>
    // --- APP CONTROLLER ---
    const app = {
      views: {
        blog: document.getElementById('postsSection'),
        project: document.getElementById('projectsSection'),
        about: document.getElementById('aboutSection'),
        single: document.getElementById('singlePostView'),
        search: document.getElementById('searchResultsPage')
      },
      nav: document.querySelectorAll('.nav-item'),
      feed: document.getElementById('postsFeed'),
      dateEl: document.getElementById('dateDisplay'),
      currentPostIndex: -1
    };

    // --- INITIALIZATION ---
    function init() {
      renderHijriDate();
      renderFeed();
      setupListeners();
      checkUrlParams();
    }

    // --- DATE (Simplified for Mobile Compatibility) ---
    function renderHijriDate() {
      try {
        const now = new Date();
        const hijriFormatter = new Intl.DateTimeFormat('en-US-u-ca-islamic', { day: 'numeric', month: 'long', year: 'numeric' });
        app.dateEl.textContent = hijriFormatter.format(now);
      } catch (e) {
        // Fallback if Islamic calendar not supported on device
        app.dateEl.textContent = new Date().toLocaleDateString();
      }
    }

    // --- FEED RENDERER ---
    function renderFeed() {
      if (typeof posts === 'undefined') {
        app.feed.innerHTML = '<div class="log-entry">Data Source Not Found. Check posts.js</div>';
        return;
      }

      app.feed.innerHTML = '';
      
      // Sort by ID desc (newest first)
      const sortedPosts = [...posts].sort((a, b) => b.id - a.id);

      sortedPosts.forEach(post => {
        const el = document.createElement('div');
        el.className = 'log-entry';
        el.innerHTML = `
          <h3 class="entry-title">${post.title}</h3>
          <div class="entry-excerpt">${post.excerpt}</div>
          <div class="entry-footer">
             <div>LOG #${post.id}</div>
             <div>${post.date}</div>
          </div>
        `;
        el.onclick = () => openPost(post);
        app.feed.appendChild(el);
      });
    }

    // --- NAVIGATION ---
    function switchTab(tabName) {
      app.nav.forEach(el => el.classList.toggle('active', el.dataset.tab === tabName));
      Object.values(app.views).forEach(el => el.classList.remove('active'));
      if(app.views[tabName]) app.views[tabName].classList.add('active');
      window.scrollTo(0,0);
    }

    function openPost(post) {
      // UI Updates
      Object.values(app.views).forEach(el => el.classList.remove('active'));
      app.views.single.classList.add('active');
      document.getElementById('singlePostTitle').textContent = post.title;
      document.getElementById('singlePostDate').textContent = post.date;
      document.getElementById('singlePostBody').innerHTML = post.body;
      
      // Update URL & Title
      document.title = `${post.title} — Mission Seventy`;
      window.history.pushState({postId: post.id}, post.title, `?post=${post.id}`);
      window.scrollTo(0,0);

      // Setup Next/Prev Logic
      const index = posts.findIndex(p => p.id === post.id);
      app.currentPostIndex = index;
      updatePostNavigation(index);
    }

    function updatePostNavigation(currentIndex) {
      const prevBtn = document.getElementById('prevPostBtn');
      const nextBtn = document.getElementById('nextPostBtn');
      
      // Newer Post (Previous in array, but "Newer" in time)
      if (currentIndex > 0) {
        const newer = posts[currentIndex - 1];
        prevBtn.classList.remove('disabled');
        document.getElementById('prevPostTitle').textContent = newer.title;
        prevBtn.onclick = () => openPost(newer);
      } else {
        prevBtn.classList.add('disabled');
        document.getElementById('prevPostTitle').textContent = "None";
      }

      // Older Post (Next in array)
      if (currentIndex < posts.length - 1) {
        const older = posts[currentIndex + 1];
        nextBtn.classList.remove('disabled');
        document.getElementById('nextPostTitle').textContent = older.title;
        nextBtn.onclick = () => openPost(older);
      } else {
        nextBtn.classList.add('disabled');
        document.getElementById('nextPostTitle').textContent = "None";
      }
    }

    function closePost() {
      switchTab('blog');
      document.title = 'Mission Seventy — The Laboratory';
      history.pushState(null, null, window.location.pathname); 
    }

    // --- SEARCH ---
    function runSearch(query) {
      if(!query) return;
      Object.values(app.views).forEach(el => el.classList.remove('active'));
      app.views.search.classList.add('active');
      const results = posts.filter(p => p.title.toLowerCase().includes(query) || p.body.toLowerCase().includes(query));
      const list = document.getElementById('searchResultsList');
      list.innerHTML = '';
      if(results.length === 0) {
        list.innerHTML = '<p style="font-family:var(--font-mono)">No matches found.</p>';
      } else {
        results.forEach(post => {
          const el = document.createElement('div');
          el.className = 'log-entry';
          el.innerHTML = `<h3 class="entry-title">${post.title}</h3><p class="entry-excerpt">${post.excerpt}</p>`;
          el.onclick = () => openPost(post);
          list.appendChild(el);
        });
      }
    }

    // --- LISTENERS ---
    function setupListeners() {
      app.nav.forEach(btn => btn.addEventListener('click', () => switchTab(btn.dataset.tab)));
      document.getElementById('logoClick').addEventListener('click', () => switchTab('blog'));
      document.getElementById('backBtn').addEventListener('click', closePost);
      document.getElementById('clearSearchBtn').addEventListener('click', () => switchTab('blog'));
      
      const searchInput = document.getElementById('searchInput');
      searchInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') runSearch(searchInput.value.toLowerCase()); });

      // Share Button
      document.getElementById('shareCopyBtn').addEventListener('click', () => {
        const url = window.location.href;
        navigator.clipboard.writeText(url).then(() => {
          const btn = document.getElementById('shareCopyBtn');
          const originalText = btn.textContent;
          btn.textContent = "COPIED!";
          setTimeout(() => btn.textContent = originalText, 2000);
        });
      });
    }

    function checkUrlParams() {
      const urlParams = new URLSearchParams(window.location.search);
      const postId = urlParams.get('post');
      if (postId && typeof posts !== 'undefined') {
        const post = posts.find(p => p.id == postId);
        if (post) openPost(post);
      }
    }

    init();
  </script>
</body>
</html>
